<!DOCTYPE HTML>
<html>

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>Claw Pie Chart</title>

	<!-- this code to include Highcharts with jQuery-->
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>

	<!--this code is the required highcharts javascript file -->
	<script src="http://code.highcharts.com/highcharts.js"></script>
	<script src="https://code.highcharts.com/modules/data.js"></script>
	<script src="https://code.highcharts.com/modules/drilldown.js"></script>
	<script src="test.js">
	</script>


	<script type="text/javascript">
		$(function() {

			$.ajax({
				url: "http://localhost:8080/animals",
				method: "GET"
			}).then(function(data) {

				var dogClaws = {},
            catClaws = {};
				for (i = 0; i < data.length; i++) {

					if (data[i].type === "dog") {
						if (dogClaws[data[i].claws] === undefined) {
							dogClaws[data[i].claws] = 1;
						} else if (dogClaws[data[i].claws]) {
							dogClaws[data[i].claws]++;
						}
					}
          if (data[i].type === "cat") {
            if (catClaws[data[i].claws] === undefined) {
              catClaws[data[i].claws] = 1;
            } else if (catClaws[data[i].claws]) {
              catClaws[data[i].claws]++;
            }
          }
				}

				Highcharts.chart('container', {
					chart: {
						type: 'pie'
					},
					title: {
						text: 'Browser market shares. January, 2018'
					},
					subtitle: {
						text: 'Click the slices to view versions. Source: <a href="http://statcounter.com" target="_blank">statcounter.com</a>'
					},
					plotOptions: {
						series: {
							dataLabels: {
								enabled: true,
								format: '{point.name}: {point.y:f}%'
							}
						}
					},

					tooltip: {
						headerFormat: '<span style="font-size:11px">{series.name}</span><br>',
						pointFormat: '<span style="color:{point.color}">{point.name}</span>: <b>{point.y:f}%</b> of total<br/>'
					},

					"series": [{
						"name": "Browsers",
						"colorByPoint": true,
						"data": [{
								"name": "Sharp",
								"y": catClaws.sharp + dogClaws.sharp,
								"drilldown": "sharp"
							},
							{
								"name": "Dull",
								"y": catClaws.dull + dogClaws.dull,
								"drilldown": "dull"
							}
						]
					}],
					"drilldown": {
						"series": [{
								"name": "Sharp",
								"id": "sharp",
								"data": [
									[
										"dog",
										dogClaws.sharp
									],
									[
										"cat",
										catClaws.sharp
									],

								]
							},
							{
								"name": "Dull",
								"id": "dull",
								"data": [
									[
										"dog",
										dogClaws.dull
									],
									[
										"cat",
										catClaws.sharp
									],
								]
							}
						]
					}
				});
			});
		});
	</script>
</head>

<body>
	<div id="container" style="min-width: 310px; height: 400px; max-width: 600px; margin: 0 auto"></div>
</body>

</html>
